<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.23">
<meta name="author" content="Auteur: Corentin Chiodo">
<title>Ressources Utiles - Python</title>
<link rel="stylesheet" href="../stylesheets/colony.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.3/styles/github.min.css">
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>Ressources Utiles - Python</h1>
<div class="details">
<span id="author" class="author">Auteur: Corentin Chiodo</span><br>
<span id="revdate">Date</span>
<br><span id="revremark">: 2024-05-29</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table des matières - Python</div>
<ul class="sectlevel2">
<li><a href="#_renvoyer_un_booléen_en_vérifiant_si_un_répertoire_est_vide_ou_non">Renvoyer un booléen en vérifiant si un répertoire est vide ou non.</a></li>
<li><a href="#_comment_récupérer_les_arguments_passés_à_un_script">Comment récupérer les arguments passés à un script ?</a></li>
<li><a href="#_comment_convertir_un_chemin_windows_en_un_chemin_linux">Comment convertir un chemin windows en un chemin linux ?</a></li>
<li><a href="#_terminer_un_processus_via_son_nom_cli">Terminer un processus via son nom [CLI]</a></li>
<li><a href="#_insérer_une_image_dans_un_pdf">Insérer une image dans un pdf</a></li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="index.html">Home <span class="icon"><i class="fa fa-home"></i></span></a></th>
<th class="tableblock halign-left valign-top"><a href="one.html">One</a></th>
<th class="tableblock halign-left valign-top"><a href="two.html">Two</a></th>
<th class="tableblock halign-left valign-top"><a href="three.html">Three</a></th>
</tr>
</thead>
</table>
<div class="paragraph right text-center">
<p><span class="icon Maroon"><i class="fa fa-file-text-o fa-5x"></i></span></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_renvoyer_un_booléen_en_vérifiant_si_un_répertoire_est_vide_ou_non">Renvoyer un booléen en vérifiant si un répertoire est vide ou non.</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import os <i class="conum" data-value="1"></i><b>(1)</b>
path = r"C:\Users\Coren\Downloads\bat peinture"

def empty_dir(path):
    return not os.listdir(path) <i class="conum" data-value="2"></i><b>(2)</b>

print(empty_dir(path))</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>module nécessaire.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>retourne False si répertoire contient au moins un fichier.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Cette fonction peut être utilisée dans de nombreux cas, par exemple pour nettoyer automatiquement un répertoire en supprimant les fichiers et sous-répertoires vides, ou pour vérifier si un répertoire est prêt à être utilisé pour stocker des données.
</td>
</tr>
</table>
</div>
<hr>
</div>
<div class="sect2">
<h3 id="_comment_récupérer_les_arguments_passés_à_un_script">Comment récupérer les arguments passés à un script ?</h3>
<div class="listingblock">
<div class="title">Exemple</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">nom = sys.argv[1]
age = sys.argv[2]
print("Bonjour {0}, vous avez {1} ans.".format(nom, age)) <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>script.py corentin 28</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>&#8658; Bonjour corentin, vous avez 28 ans.</p>
</div>
<hr>
</div>
<div class="sect2">
<h3 id="_comment_convertir_un_chemin_windows_en_un_chemin_linux">Comment convertir un chemin windows en un chemin linux ?</h3>
<div class="listingblock">
<div class="title">Méthode n°1:</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import os

def convert_path_to_linux(path):
    # Normalise le chemin pour supprimer les doubles backslashes
    normalized_path = os.path.normpath(path)
    # Remplace les backslashes par des slashes
    return normalized_path.replace('\\', '/')

windows_path = r'C:\\Users\\Username\\Documents\\file.txt'
linux_path = convert_path_to_linux(windows_path)
print(linux_path)  # Output: 'C:/Users/Username/Documents/file.txt'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Méthode n°2 : avec une expression régulière</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import os
import re <i class="conum" data-value="1"></i><b>(1)</b>

def convert_path_to_linux(path):
    # Normalise le chemin pour supprimer les doubles backslashes
    normalized_path = os.path.normpath(path)
    return re.sub(r'\\+', '/', path)

windows_path = r'C:\\Users\\Username\\Documents\\file.txt'
linux_path = convert_path_to_linux(windows_path)
print(linux_path)  # Output: 'C:/Users/Username/Documents/file.txt'</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>module pour les expressions régulières</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<a href="Ressources - Regex.html">Voir Regex</a> pour plus d&#8217;informations.
</td>
</tr>
</table>
</div>
<hr>
</div>
<div class="sect2">
<h3 id="_terminer_un_processus_via_son_nom_cli">Terminer un processus via son nom [CLI]</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import psutil <i class="conum" data-value="1"></i><b>(1)</b>
import re

def terminate_process(process_name):
    """
    Terminates processes whose names match the given pattern.

    Args:
        process_name (str): The name (or pattern) of the process to terminate.
    """
    try:
        # Flag to check if any processes were found
        processes_found = False

        # Iterate over all running processes
        for proc in psutil.process_iter(['pid', 'name']):
            try:
                # Search for the process name using a case-insensitive regex
                if re.search(process_name, proc.info['name'], re.IGNORECASE): <i class="conum" data-value="2"></i><b>(2)</b>
                    processes_found = True
                    print(f"Terminating process {proc.info['name']} with PID {proc.info['pid']}")

                    # Terminate the process
                    proc.terminate()

                    # Wait for the process to terminate, with a timeout of 3 seconds
                    proc.wait(timeout=3)
            except (psutil.NoSuchProcess, psutil.AccessDenied, psutil.ZombieProcess):
                # Handle exceptions for non-existing, inaccessible, or zombie processes
                continue

        # If no processes were found, inform the user
        if not processes_found:
            print(f"No process matching '{process_name}' found.")
    except Exception as e:
        # General exception handling
        print(f"Error while terminating processes: {e}")

if __name__ == "__main__":
    # Prompt the user to enter the name of the process to terminate
    process_name = input("Process to terminate: \n")
    terminate_process(process_name)</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>psutil (process and system utilities) est une bibliothèque multiplateforme permettant de récupérer des informations sur les processus en cours d&#8217;exécution et l&#8217;utilisation du système (CPU, mémoire, disques, réseau, capteurs) en Python. Elle est principalement utile pour la surveillance du système, le profilage, la limitation des ressources des processus et la gestion des processus en cours d&#8217;exécution. Elle implémente de nombreuses fonctionnalités offertes par des outils en ligne de commande classiques UNIX tels que ps, top, iotop, lsof, netstat, ifconfig, free et d&#8217;autres.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>re.IGNORECASE</code> pour rendre la recherche de nom de processus insensible à la casse</td>
</tr>
</table>
</div>
<hr>
</div>
<div class="sect2">
<h3 id="_insérer_une_image_dans_un_pdf">Insérer une image dans un pdf</h3>
<div class="listingblock">
<div class="title">Exemple</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import fitz  # PyMuPDF <i class="conum" data-value="1"></i><b>(1)</b> <i class="conum" data-value="2"></i><b>(2)</b>

# Ouvrir le document PDF
pdf_document = fitz.open("mon_document.pdf")

# Ouvrir une page spécifique
page = pdf_document[0]

# Définir l'image à insérer
image_path = "mon_image.png"
image_rect = fitz.Rect(100, 100, 300, 300)  # Position et taille de l'image

# Insérer l'image
page.insert_image(image_rect, filename=image_path)

# Enregistrer le document PDF modifié
pdf_document.save("document_modifie.pdf")</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><a href="https://pypi.org/project/PyMuPDF/" class="bare">https://pypi.org/project/PyMuPDF/</a></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><a href="https://pymupdf.readthedocs.io/en/latest/tutorial.html#modifying-creating-re-arranging-and-deleting-pages" class="bare">https://pymupdf.readthedocs.io/en/latest/tutorial.html#modifying-creating-re-arranging-and-deleting-pages</a></td>
</tr>
</table>
</div>
<hr>
<div class="listingblock">
<div class="content">
<pre>@startuml
Bob -&gt; Alice : hello
Alice --&gt; Bob : goodbye
@enduml</pre>
</div>
</div>
<hr>
<div class="listingblock">
<div class="content">
<pre>@startuml
skinparam classAttributeIconSize 0

package "pkg Classes Diagram" {

  class userAuth {
    - idUserAuth: int
    - login: string
    - password: string
    - last_login: date
  }

  class ticket {
    - idTicket: int
    - ticketSubject: string
    - incidentType: string
    - ticketDescription: string
    - ticketStatus: string
    - ticketPriority: string
    - ticketDate: date
    - ticketAttachedImage: string
    - ticketAttachedFile: string
  }

  class conversation {
    - idConversation: int
  }

  class message {
    - idMessage: int
    - messageContent: string
    - messageDate: date
    - messageAttachedFile: string
    - messageAttachedImage: string
  }

  class viewTicket {
    + answerTicket(idConversation: int): void
    + addMessageAttachmentFile(attachmentFilePath: string): void
    + addMessageAttachmentImage(attachmentImagePath: string): void
    + cancelViewTicket(): void
    + closeTicket(idTicket: int, ticketStatus: string): void
  }

  class createTicketForm {
    + validateTicketForm(): void
    + addAttachmentFile(attachmentFilePath: string): void
    + addAttachmentImage(attachmentImagePath: string): void
    + cancelTicketForm(): void
    + changeStatus(ticket: Ticket, ticketStatus: string): void
    + changePriority(ticket: Ticket, ticketPriority: string): void
  }

  class createTicketPage {
    + createTicketForm(): void
    + selectTicket(idTicket: int): void
    + filterTickets(): ticket[]
    + viewTicket(idTicket: int): void
    + displayCreateTicketPage(): void
  }

  class managementTickets {
    + validateTicketForm(ticketSubject: string, etc: int): void
    + addAttachmentFile(attachmentFilePath: string): void
    + addAttachmentImage(attachmentImagePath: string): void
    + changeStatus(ticket: Ticket, ticketStatus: string): void
    + createTicket(): void
    + changePriority(ticket: Ticket, ticketPriority: string): void
    + viewTicket(idTicket: int): void
    + selectTicket(idTicket: int): void
    + filterTickets(): ticket[]
    + displayCreateTicketPage(): void
    + answerTicket(idConversation: int): void
    + addMessageAttachmentFile(attachmentFilePath: string): void
    + addMessageAttachmentImage(attachmentImagePath: string): void
    + cancelViewTicket(): void
    + closeTicket(idTicket: int, ticketStatus: string): void
  }

  enum ticketPriority {
    high
    middle
    low
  }

  enum ticketStatus {
    in_progress
    to_be_processed
    processed
  }

  enum incidentType {
    mechanical_failure
    software_problem
    user_error
  }

  viewTicket ..&gt; userAuth: uses
  createTicketForm ..&gt; userAuth: uses
  createTicketPage ..&gt; userAuth: uses

  viewTicket ..&gt; conversation: uses
  viewTicket ..&gt; message: uses

  createTicketForm ..&gt; ticket: uses

  createTicketPage ..&gt; ticket: uses

  managementTickets ..&gt; ticket: uses
  managementTickets ..&gt; conversation: uses
  managementTickets ..&gt; message: uses

  ticket --|&gt; ticketPriority
  ticket --|&gt; ticketStatus
  ticket --|&gt; incidentType

  conversation "1" -- "0..*" message
  ticket "1" -- "1..*" managementTickets
}
@enduml</pre>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2024-05-29 14:32:03 +0200
</div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.3/highlight.min.js"></script>
<script>
if (!hljs.initHighlighting.called) {
  hljs.initHighlighting.called = true
  ;[].slice.call(document.querySelectorAll('pre.highlight > code[data-lang]')).forEach(function (el) { hljs.highlightBlock(el) })
}
</script>
</body>
</html>